{"ast":null,"code":"import _defineProperty from\"C:/xampp/htdocs/Partnr/partnrd/partnrd_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/xampp/htdocs/Partnr/partnrd/partnrd_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/xampp/htdocs/Partnr/partnrd/partnrd_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import axios from\"axios\";import{useHistory}from\"react-router-dom/cjs/react-router-dom.min\";/**\r\n * User Signup function, uses api to validate user looking to register \r\n * and adds them to the database.\r\n * \r\n * @param {*} validate \r\n * @returns \r\n */export var useSignup=function useSignup(validate){var _useState=useState({name:\"\",email:\"\",password:\"\",password2:\"\"}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var _useState3=useState({error:false,message:\"\"}),_useState4=_slicedToArray(_useState3,2),response=_useState4[0],setResponse=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),errors=_useState6[0],setErrors=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSubmitting=_useState8[0],setIsSubmitting=_useState8[1];var _useState9=useState({state:false,message:\"\"}),_useState10=_slicedToArray(_useState9,2),success=_useState10[0],setSuccess=_useState10[1];var handleRegisterChange=function handleRegisterChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();var response={error:false,message:errors};setResponse(response);setErrors(validate(values));setIsSubmitting(true);};useEffect(function(){if(Object.keys(errors).length===0&&isSubmitting){var data=values;axios.post(process.env.REACT_APP_API+\"/api/client/register\",data).then(function(res){var success={state:true,message:\"Email Verification email sent\"};setSuccess(success);}).catch(function(err){var error=err.response.data;var s=Object.values(error.errors);s.join(\" \");var response={error:true,message:s};setResponse(response);setIsSubmitting(false);});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[errors]);return{handleRegisterChange:handleRegisterChange,values:values,handleSubmit:handleSubmit,errors:errors,response:response,success:success};};/**\r\n * User Login logic, uses axios to post data to the server,\r\n * Validation is performed client side and server side. \r\n * Authentication is performed server side and messages are posted\r\n * to the front-end to display in the application. \r\n * @param {*} validate \r\n * @returns \r\n */export var useLogin=function useLogin(validate){var _useState11=useState({email:\"\",password:\"\"}),_useState12=_slicedToArray(_useState11,2),fields=_useState12[0],setValues=_useState12[1];var _useState13=useState({error:false,type:\"\",message:\"\"}),_useState14=_slicedToArray(_useState13,2),response=_useState14[0],setResponse=_useState14[1];var _useState15=useState({}),_useState16=_slicedToArray(_useState15,2),errors=_useState16[0],setErrors=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isSubmitting=_useState18[0],setIsSubmitting=_useState18[1];var history=useHistory();var handleLoginChange=function handleLoginChange(e){var _e$target2=e.target,name=_e$target2.name,value=_e$target2.value;setValues(_objectSpread(_objectSpread({},fields),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();var response={error:false,message:errors};setResponse(response);setErrors(validate(fields));setIsSubmitting(true);};useEffect(function(){if(Object.keys(errors).length===0&&isSubmitting){var data=fields;axios.post(process.env.REACT_APP_API+\"/api/login\",data,{headers:{Accept:\"application/json\"}}).then(function(res){//console.log(res.json());\nsessionStorage.setItem(\"xrsf\",res.data.access_token);history.push(\"/\");}).catch(function(err){var errors=\"\";var type=\"\";console.log(err.response.data);if(err.response.data.errors.email){errors=err.response.data.errors.email;}else{errors=err.response.data.errors;type=err.response.data.type;}var response={error:true,type:type,message:errors};setResponse(response);setIsSubmitting(false);});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[errors]);return{handleLoginChange:handleLoginChange,fields:fields,handleSubmit:handleSubmit,errors:errors,response:response};};export var useEmail=function useEmail(validate){var _useState19=useState({email:\"\"}),_useState20=_slicedToArray(_useState19,2),fields=_useState20[0],setValues=_useState20[1];var _useState21=useState({}),_useState22=_slicedToArray(_useState21,2),errors=_useState22[0],setErrors=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),isSubmitting=_useState24[0],setIsSubmitting=_useState24[1];var _useState25=useState({error:false,message:\"\"}),_useState26=_slicedToArray(_useState25,2),response=_useState26[0],setResponse=_useState26[1];var _useState27=useState({state:false,message:\"\"}),_useState28=_slicedToArray(_useState27,2),success=_useState28[0],setSuccess=_useState28[1];var handleEmailChange=function handleEmailChange(e){var _e$target3=e.target,name=_e$target3.name,value=_e$target3.value;setValues(_objectSpread(_objectSpread({},fields),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();var response={error:false,message:errors};setResponse(response);setErrors(validate(fields));setIsSubmitting(true);};useEffect(function(){if(Object.keys(errors).length===0&&isSubmitting){var data=fields;axios.post(process.env.REACT_APP_API+\"/api/password/email\",data,{headers:{Accept:\"application/json\"}}).then(function(res){var success={state:true,message:res.message};setSuccess(success);}).catch(function(err){var errors;if(err.response.data.errors.email){errors=err.response.data.errors.email[0];}else{errors=err.response.data.errors;}var response={error:true,message:errors};console.log(errors);setResponse(response);setIsSubmitting(false);});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[errors]);return{handleEmailChange:handleEmailChange,fields:fields,handleSubmit:handleSubmit,errors:errors,response:response,success:success};};var getToken=function getToken(){var params=new URLSearchParams(window.location.search);if(params.has(\"token\")){return params.get(\"token\");}return\"\";};var getUserId=function getUserId(){var params=new URLSearchParams(window.location.search);if(params.has(\"id\")){return params.get(\"id\");}return\"\";};export var useResetPassword=function useResetPassword(validate){var _useState29=useState({id:getUserId(),token:getToken(),password:\"\",password_confirmation:\"\"}),_useState30=_slicedToArray(_useState29,2),fields=_useState30[0],setValues=_useState30[1];var _useState31=useState({}),_useState32=_slicedToArray(_useState31,2),errors=_useState32[0],setErrors=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),isSubmitting=_useState34[0],setIsSubmitting=_useState34[1];var _useState35=useState({error:false,message:\"\"}),_useState36=_slicedToArray(_useState35,2),response=_useState36[0],setResponse=_useState36[1];var _useState37=useState({state:false,message:\"\"}),_useState38=_slicedToArray(_useState37,2),success=_useState38[0],setSuccess=_useState38[1];var handleChange=function handleChange(e){var _e$target4=e.target,name=_e$target4.name,value=_e$target4.value;setValues(_objectSpread(_objectSpread({},fields),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();var response={error:false,message:errors};setResponse(response);setErrors(validate(fields));setIsSubmitting(true);};useEffect(function(){if(Object.keys(errors).length===0&&isSubmitting){var data=fields;axios.post(process.env.REACT_APP_API+\"/api/password/reset\",data,{headers:{Accept:\"application/json\"}}).then(function(res){var success={state:true,message:res.message};console.log(success);setSuccess(success);}).catch(function(err){var errors=err.response.data.errors;var response={error:true,message:errors};console.log(errors);setResponse(response);setIsSubmitting(false);});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[errors]);return{handleChange:handleChange,fields:fields,handleSubmit:handleSubmit,errors:errors,response:response,success:success};};","map":{"version":3,"sources":["C:/xampp/htdocs/Partnr/partnrd/partnrd_frontend/src/clientAuth/useAuth.js"],"names":["useState","useEffect","axios","useHistory","useSignup","validate","name","email","password","password2","values","setValues","error","message","response","setResponse","errors","setErrors","isSubmitting","setIsSubmitting","state","success","setSuccess","handleRegisterChange","e","target","value","handleSubmit","preventDefault","Object","keys","length","data","post","process","env","REACT_APP_API","then","res","catch","err","s","join","useLogin","fields","type","history","handleLoginChange","headers","Accept","sessionStorage","setItem","access_token","push","console","log","useEmail","handleEmailChange","getToken","params","URLSearchParams","window","location","search","has","get","getUserId","useResetPassword","id","token","password_confirmation","handleChange"],"mappings":"mfAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,2CAA3B,CAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,QAAD,CACzB,CACI,cAA4BL,QAAQ,CAAC,CACrCM,IAAI,CAAE,EAD+B,CAErCC,KAAK,CAAE,EAF8B,CAGrCC,QAAQ,CAAE,EAH2B,CAIrCC,SAAS,CAAE,EAJ0B,CAAD,CAApC,wCAAOC,MAAP,eAAeC,SAAf,eAOF,eAAgCX,QAAQ,CAAC,CACvCY,KAAK,CAAE,KADgC,CAEvCC,OAAO,CAAE,EAF8B,CAAD,CAAxC,yCAAOC,QAAP,eAAiBC,WAAjB,eAKA,eAA4Bf,QAAQ,CAAC,EAAD,CAApC,yCAAOgB,MAAP,eAAeC,SAAf,eAEA,eAAwCjB,QAAQ,CAAC,KAAD,CAAhD,yCAAOkB,YAAP,eAAqBC,eAArB,eACA,eAA8BnB,QAAQ,CAAC,CACrCoB,KAAK,CAAE,KAD8B,CAErCP,OAAO,CAAE,EAF4B,CAAD,CAAtC,0CAAOQ,OAAP,gBAAgBC,UAAhB,gBAKA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,CAAD,CAAO,CAClC,cAAwBA,CAAC,CAACC,MAA1B,CAAQnB,IAAR,WAAQA,IAAR,CAAcoB,KAAd,WAAcA,KAAd,CACAf,SAAS,gCACFD,MADE,wBAENJ,IAFM,CAEAoB,KAFA,GAAT,CAID,CAND,CAQA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACH,CAAD,CAAO,CAC1BA,CAAC,CAACI,cAAF,GACA,GAAMd,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,KADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAIAD,WAAW,CAACD,QAAD,CAAX,CACAG,SAAS,CAACZ,QAAQ,CAACK,MAAD,CAAT,CAAT,CAEAS,eAAe,CAAC,IAAD,CAAf,CACD,CAVD,CAYAlB,SAAS,CAAC,UAAM,CACd,GAAI4B,MAAM,CAACC,IAAP,CAAYd,MAAZ,EAAoBe,MAApB,GAA+B,CAA/B,EAAoCb,YAAxC,CAAsD,CACpD,GAAMc,CAAAA,IAAI,CAAGtB,MAAb,CACAR,KAAK,CACF+B,IADH,CACQC,OAAO,CAACC,GAAR,CAAYC,aAAZ,uBADR,CAC4DJ,IAD5D,EAEGK,IAFH,CAEQ,SAACC,GAAD,CAAS,CACb,GAAMjB,CAAAA,OAAO,CAAG,CACdD,KAAK,CAAE,IADO,CAEdP,OAAO,CAAE,+BAFK,CAAhB,CAIAS,UAAU,CAACD,OAAD,CAAV,CACD,CARH,EASGkB,KATH,CASS,SAACC,GAAD,CAAS,CACd,GAAM5B,CAAAA,KAAK,CAAG4B,GAAG,CAAC1B,QAAJ,CAAakB,IAA3B,CACA,GAAMS,CAAAA,CAAC,CAAGZ,MAAM,CAACnB,MAAP,CAAcE,KAAK,CAACI,MAApB,CAAV,CACAyB,CAAC,CAACC,IAAF,CAAO,GAAP,EACA,GAAM5B,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,IADQ,CAEfC,OAAO,CAAE4B,CAFM,CAAjB,CAIA1B,WAAW,CAACD,QAAD,CAAX,CACAK,eAAe,CAAC,KAAD,CAAf,CACD,CAnBH,EAoBD,CACD;AACD,CAzBQ,CAyBN,CAACH,MAAD,CAzBM,CAAT,CA2BA,MAAO,CACLO,oBAAoB,CAApBA,oBADK,CAELb,MAAM,CAANA,MAFK,CAGLiB,YAAY,CAAZA,YAHK,CAILX,MAAM,CAANA,MAJK,CAKLF,QAAQ,CAARA,QALK,CAMLO,OAAO,CAAPA,OANK,CAAP,CAQD,CA7EM,CA+EP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAO,IAAMsB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACtC,QAAD,CACxB,CACE,gBAA4BL,QAAQ,CAAC,CACnCO,KAAK,CAAE,EAD4B,CAEnCC,QAAQ,CAAE,EAFyB,CAAD,CAApC,2CAAOoC,MAAP,gBAAejC,SAAf,gBAKA,gBAAgCX,QAAQ,CAAC,CACvCY,KAAK,CAAE,KADgC,CAEvCiC,IAAI,CAAE,EAFiC,CAGvChC,OAAO,CAAE,EAH8B,CAAD,CAAxC,2CAAOC,QAAP,gBAAiBC,WAAjB,gBAMA,gBAA4Bf,QAAQ,CAAC,EAAD,CAApC,2CAAOgB,MAAP,gBAAeC,SAAf,gBACA,gBAAwCjB,QAAQ,CAAC,KAAD,CAAhD,2CAAOkB,YAAP,gBAAqBC,eAArB,gBACA,GAAM2B,CAAAA,OAAO,CAAG3C,UAAU,EAA1B,CAEA,GAAM4C,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACvB,CAAD,CAAO,CAC/B,eAAwBA,CAAC,CAACC,MAA1B,CAAQnB,IAAR,YAAQA,IAAR,CAAcoB,KAAd,YAAcA,KAAd,CACAf,SAAS,gCACJiC,MADI,wBAENtC,IAFM,CAECoB,KAFD,GAAT,CAID,CAND,CAQA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACH,CAAD,CAAO,CAC1BA,CAAC,CAACI,cAAF,GACA,GAAMd,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,KADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAIAD,WAAW,CAACD,QAAD,CAAX,CACAG,SAAS,CAACZ,QAAQ,CAACuC,MAAD,CAAT,CAAT,CAEAzB,eAAe,CAAC,IAAD,CAAf,CACD,CAVD,CAYAlB,SAAS,CAAC,UAAM,CACd,GAAI4B,MAAM,CAACC,IAAP,CAAYd,MAAZ,EAAoBe,MAApB,GAA+B,CAA/B,EAAoCb,YAAxC,CAAsD,CACpD,GAAMc,CAAAA,IAAI,CAAGY,MAAb,CACA1C,KAAK,CACF+B,IADH,CACQC,OAAO,CAACC,GAAR,CAAYC,aAAZ,aADR,CACkDJ,IADlD,CACwD,CACpDgB,OAAO,CAAE,CAAEC,MAAM,CAAE,kBAAV,CAD2C,CADxD,EAIGZ,IAJH,CAIQ,SAACC,GAAD,CAAS,CACb;AACAY,cAAc,CAACC,OAAf,CAAuB,MAAvB,CAA+Bb,GAAG,CAACN,IAAJ,CAASoB,YAAxC,EACAN,OAAO,CAACO,IAAR,CAAa,GAAb,EACD,CARH,EASGd,KATH,CASS,SAACC,GAAD,CAAS,CACd,GAAIxB,CAAAA,MAAM,CAAG,EAAb,CACA,GAAI6B,CAAAA,IAAI,CAAG,EAAX,CACAS,OAAO,CAACC,GAAR,CAAYf,GAAG,CAAC1B,QAAJ,CAAakB,IAAzB,EACA,GAAIQ,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAAlB,CAAyBT,KAA7B,CAAoC,CAClCS,MAAM,CAAGwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAAlB,CAAyBT,KAAlC,CACD,CAFD,IAEO,CACLS,MAAM,CAAGwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAA3B,CACA6B,IAAI,CAAGL,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBa,IAAzB,CACD,CACD,GAAM/B,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,IADQ,CAEfiC,IAAI,CAAEA,IAFS,CAGfhC,OAAO,CAAEG,MAHM,CAAjB,CAKAD,WAAW,CAACD,QAAD,CAAX,CACAK,eAAe,CAAC,KAAD,CAAf,CACD,CA1BH,EA2BD,CACD;AACD,CAhCQ,CAgCN,CAACH,MAAD,CAhCM,CAAT,CAkCA,MAAO,CAAE+B,iBAAiB,CAAjBA,iBAAF,CAAqBH,MAAM,CAANA,MAArB,CAA6BjB,YAAY,CAAZA,YAA7B,CAA2CX,MAAM,CAANA,MAA3C,CAAmDF,QAAQ,CAARA,QAAnD,CAAP,CACD,CAxEM,CA2EP,MAAO,IAAM0C,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACnD,QAAD,CAAc,CACpC,gBAA4BL,QAAQ,CAAC,CACnCO,KAAK,CAAE,EAD4B,CAAD,CAApC,2CAAOqC,MAAP,gBAAejC,SAAf,gBAIA,gBAA4BX,QAAQ,CAAC,EAAD,CAApC,2CAAOgB,MAAP,gBAAeC,SAAf,gBACA,gBAAwCjB,QAAQ,CAAC,KAAD,CAAhD,2CAAOkB,YAAP,gBAAqBC,eAArB,gBACA,gBAAgCnB,QAAQ,CAAC,CACvCY,KAAK,CAAE,KADgC,CAEvCC,OAAO,CAAE,EAF8B,CAAD,CAAxC,2CAAOC,QAAP,gBAAiBC,WAAjB,gBAKA,gBAA8Bf,QAAQ,CAAC,CACrCoB,KAAK,CAAE,KAD8B,CAErCP,OAAO,CAAE,EAF4B,CAAD,CAAtC,2CAAOQ,OAAP,gBAAgBC,UAAhB,gBAKA,GAAMmC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACjC,CAAD,CAAO,CAC/B,eAAwBA,CAAC,CAACC,MAA1B,CAAQnB,IAAR,YAAQA,IAAR,CAAcoB,KAAd,YAAcA,KAAd,CACAf,SAAS,gCACJiC,MADI,wBAENtC,IAFM,CAECoB,KAFD,GAAT,CAID,CAND,CAQA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACH,CAAD,CAAO,CAC1BA,CAAC,CAACI,cAAF,GACA,GAAMd,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,KADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAIAD,WAAW,CAACD,QAAD,CAAX,CACAG,SAAS,CAACZ,QAAQ,CAACuC,MAAD,CAAT,CAAT,CACAzB,eAAe,CAAC,IAAD,CAAf,CACD,CATD,CAWAlB,SAAS,CAAC,UAAM,CACd,GAAI4B,MAAM,CAACC,IAAP,CAAYd,MAAZ,EAAoBe,MAApB,GAA+B,CAA/B,EAAoCb,YAAxC,CAAsD,CACpD,GAAMc,CAAAA,IAAI,CAAGY,MAAb,CACA1C,KAAK,CACF+B,IADH,CACQC,OAAO,CAACC,GAAR,CAAYC,aAAZ,sBADR,CAC2DJ,IAD3D,CACiE,CAC7DgB,OAAO,CAAE,CAAEC,MAAM,CAAE,kBAAV,CADoD,CADjE,EAIGZ,IAJH,CAIQ,SAACC,GAAD,CAAS,CACb,GAAMjB,CAAAA,OAAO,CAAG,CACdD,KAAK,CAAE,IADO,CAEdP,OAAO,CAAEyB,GAAG,CAACzB,OAFC,CAAhB,CAIAS,UAAU,CAACD,OAAD,CAAV,CACD,CAVH,EAWGkB,KAXH,CAWS,SAACC,GAAD,CAAS,CACd,GAAIxB,CAAAA,MAAJ,CACA,GAAIwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAAlB,CAAyBT,KAA7B,CAAoC,CAClCS,MAAM,CAAGwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAAlB,CAAyBT,KAAzB,CAA+B,CAA/B,CAAT,CACD,CAFD,IAEO,CACLS,MAAM,CAAGwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAA3B,CACD,CAED,GAAMF,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,IADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAKAsC,OAAO,CAACC,GAAR,CAAYvC,MAAZ,EACAD,WAAW,CAACD,QAAD,CAAX,CACAK,eAAe,CAAC,KAAD,CAAf,CACD,CA3BH,EA4BD,CACD;AACD,CAjCQ,CAiCN,CAACH,MAAD,CAjCM,CAAT,CAmCA,MAAO,CACLyC,iBAAiB,CAAjBA,iBADK,CAELb,MAAM,CAANA,MAFK,CAGLjB,YAAY,CAAZA,YAHK,CAILX,MAAM,CAANA,MAJK,CAKLF,QAAQ,CAARA,QALK,CAMLO,OAAO,CAAPA,OANK,CAAP,CAQD,CA/EM,CAiFP,GAAMqC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACrB,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAf,CACA,GAAIJ,MAAM,CAACK,GAAP,CAAW,OAAX,CAAJ,CAAyB,CACvB,MAAOL,CAAAA,MAAM,CAACM,GAAP,CAAW,OAAX,CAAP,CACD,CACD,MAAO,EAAP,CACD,CAND,CAQA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtB,GAAMP,CAAAA,MAAM,CAAG,GAAIC,CAAAA,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAf,CACA,GAAIJ,MAAM,CAACK,GAAP,CAAW,IAAX,CAAJ,CAAsB,CACpB,MAAOL,CAAAA,MAAM,CAACM,GAAP,CAAW,IAAX,CAAP,CACD,CACD,MAAO,EAAP,CACD,CAND,CAQA,MAAO,IAAME,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAAC9D,QAAD,CAAc,CAC5C,gBAA4BL,QAAQ,CAAC,CACnCoE,EAAE,CAAEF,SAAS,EADsB,CAEnCG,KAAK,CAAEX,QAAQ,EAFoB,CAGnClD,QAAQ,CAAE,EAHyB,CAInC8D,qBAAqB,CAAE,EAJY,CAAD,CAApC,2CAAO1B,MAAP,gBAAejC,SAAf,gBAOA,gBAA4BX,QAAQ,CAAC,EAAD,CAApC,2CAAOgB,MAAP,gBAAeC,SAAf,gBACA,gBAAwCjB,QAAQ,CAAC,KAAD,CAAhD,2CAAOkB,YAAP,gBAAqBC,eAArB,gBACA,gBAAgCnB,QAAQ,CAAC,CACvCY,KAAK,CAAE,KADgC,CAEvCC,OAAO,CAAE,EAF8B,CAAD,CAAxC,2CAAOC,QAAP,gBAAiBC,WAAjB,gBAKA,gBAA8Bf,QAAQ,CAAC,CACrCoB,KAAK,CAAE,KAD8B,CAErCP,OAAO,CAAE,EAF4B,CAAD,CAAtC,2CAAOQ,OAAP,gBAAgBC,UAAhB,gBAKA,GAAMiD,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAC/C,CAAD,CAAO,CAC1B,eAAwBA,CAAC,CAACC,MAA1B,CAAQnB,IAAR,YAAQA,IAAR,CAAcoB,KAAd,YAAcA,KAAd,CACAf,SAAS,gCACJiC,MADI,wBAENtC,IAFM,CAECoB,KAFD,GAAT,CAID,CAND,CAQA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACH,CAAD,CAAO,CAC1BA,CAAC,CAACI,cAAF,GACA,GAAMd,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,KADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAIAD,WAAW,CAACD,QAAD,CAAX,CACAG,SAAS,CAACZ,QAAQ,CAACuC,MAAD,CAAT,CAAT,CACAzB,eAAe,CAAC,IAAD,CAAf,CACD,CATD,CAWAlB,SAAS,CAAC,UAAM,CACd,GAAI4B,MAAM,CAACC,IAAP,CAAYd,MAAZ,EAAoBe,MAApB,GAA+B,CAA/B,EAAoCb,YAAxC,CAAsD,CACpD,GAAMc,CAAAA,IAAI,CAAGY,MAAb,CACA1C,KAAK,CACF+B,IADH,CACQC,OAAO,CAACC,GAAR,CAAYC,aAAZ,sBADR,CAC2DJ,IAD3D,CACiE,CAC7DgB,OAAO,CAAE,CAAEC,MAAM,CAAE,kBAAV,CADoD,CADjE,EAIGZ,IAJH,CAIQ,SAACC,GAAD,CAAS,CACb,GAAMjB,CAAAA,OAAO,CAAG,CACdD,KAAK,CAAE,IADO,CAEdP,OAAO,CAAEyB,GAAG,CAACzB,OAFC,CAAhB,CAIAyC,OAAO,CAACC,GAAR,CAAYlC,OAAZ,EACAC,UAAU,CAACD,OAAD,CAAV,CACD,CAXH,EAYGkB,KAZH,CAYS,SAACC,GAAD,CAAS,CACd,GAAIxB,CAAAA,MAAM,CAAGwB,GAAG,CAAC1B,QAAJ,CAAakB,IAAb,CAAkBhB,MAA/B,CAEA,GAAMF,CAAAA,QAAQ,CAAG,CACfF,KAAK,CAAE,IADQ,CAEfC,OAAO,CAAEG,MAFM,CAAjB,CAKAsC,OAAO,CAACC,GAAR,CAAYvC,MAAZ,EACAD,WAAW,CAACD,QAAD,CAAX,CACAK,eAAe,CAAC,KAAD,CAAf,CACD,CAvBH,EAwBD,CACD;AACD,CA7BQ,CA6BN,CAACH,MAAD,CA7BM,CAAT,CA+BA,MAAO,CACLuD,YAAY,CAAZA,YADK,CAEL3B,MAAM,CAANA,MAFK,CAGLjB,YAAY,CAAZA,YAHK,CAILX,MAAM,CAANA,MAJK,CAKLF,QAAQ,CAARA,QALK,CAMLO,OAAO,CAAPA,OANK,CAAP,CAQD,CA9EM","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useHistory } from \"react-router-dom/cjs/react-router-dom.min\";\r\n\r\n/**\r\n * User Signup function, uses api to validate user looking to register \r\n * and adds them to the database.\r\n * \r\n * @param {*} validate \r\n * @returns \r\n */\r\n\r\nexport const useSignup = (validate) =>\r\n{\r\n    const [values, setValues] = useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    password2: \"\",\r\n    });\r\n   \r\n  const [response, setResponse] = useState({\r\n    error: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n  \r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [success, setSuccess] = useState({\r\n    state: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const handleRegisterChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setValues({\r\n        ...values,\r\n      [name]:value,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const response = {\r\n      error: false,\r\n      message: errors,\r\n    };\r\n    setResponse(response);\r\n    setErrors(validate(values));\r\n\r\n    setIsSubmitting(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(errors).length === 0 && isSubmitting) {\r\n      const data = values;\r\n      axios\r\n        .post(process.env.REACT_APP_API + `/api/client/register`, data)\r\n        .then((res) => {\r\n          const success = {\r\n            state: true,\r\n            message: \"Email Verification email sent\",\r\n          };\r\n          setSuccess(success);\r\n        })\r\n        .catch((err) => {\r\n          const error = err.response.data;\r\n          const s = Object.values(error.errors);\r\n          s.join(\" \");\r\n          const response = {\r\n            error: true,\r\n            message: s,\r\n          };\r\n          setResponse(response);\r\n          setIsSubmitting(false);\r\n        });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [errors]);\r\n\r\n  return {\r\n    handleRegisterChange,\r\n    values,\r\n    handleSubmit,\r\n    errors,\r\n    response,\r\n    success\r\n  };\r\n};\r\n\r\n/**\r\n * User Login logic, uses axios to post data to the server,\r\n * Validation is performed client side and server side. \r\n * Authentication is performed server side and messages are posted\r\n * to the front-end to display in the application. \r\n * @param {*} validate \r\n * @returns \r\n */\r\n\r\nexport const useLogin = (validate) =>\r\n{\r\n  const [fields, setValues] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const [response, setResponse] = useState({\r\n    error: false,\r\n    type: \"\", \r\n    message: \"\",\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const history = useHistory();\r\n\r\n  const handleLoginChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setValues({\r\n      ...fields,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const response = {\r\n      error: false,\r\n      message: errors,\r\n    };\r\n    setResponse(response);\r\n    setErrors(validate(fields));\r\n\r\n    setIsSubmitting(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(errors).length === 0 && isSubmitting) {\r\n      const data = fields;\r\n      axios\r\n        .post(process.env.REACT_APP_API + `/api/login`, data, {\r\n          headers: { Accept: \"application/json\" },\r\n        })\r\n        .then((res) => {\r\n          //console.log(res.json());\r\n          sessionStorage.setItem(\"xrsf\", res.data.access_token);\r\n          history.push(\"/\");\r\n        })\r\n        .catch((err) => {\r\n          let errors = \"\";\r\n          let type = \"\";\r\n          console.log(err.response.data);\r\n          if (err.response.data.errors.email) {\r\n            errors = err.response.data.errors.email;\r\n          } else {\r\n            errors = err.response.data.errors;\r\n            type = err.response.data.type;\r\n          }\r\n          const response = {\r\n            error: true,\r\n            type: type,\r\n            message: errors,\r\n          };\r\n          setResponse(response);\r\n          setIsSubmitting(false);\r\n        });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [errors]);\r\n\r\n  return { handleLoginChange, fields, handleSubmit, errors, response };\r\n};\r\n\r\n\r\nexport const useEmail = (validate) => {\r\n  const [fields, setValues] = useState({\r\n    email: \"\",\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [response, setResponse] = useState({\r\n    error: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const [success, setSuccess] = useState({\r\n    state: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const handleEmailChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setValues({\r\n      ...fields,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const response = {\r\n      error: false,\r\n      message: errors,\r\n    };\r\n    setResponse(response);\r\n    setErrors(validate(fields));\r\n    setIsSubmitting(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(errors).length === 0 && isSubmitting) {\r\n      const data = fields;\r\n      axios\r\n        .post(process.env.REACT_APP_API + `/api/password/email`, data, {\r\n          headers: { Accept: \"application/json\" },\r\n        })\r\n        .then((res) => {\r\n          const success = {\r\n            state: true,\r\n            message: res.message,\r\n          };\r\n          setSuccess(success);\r\n        })\r\n        .catch((err) => {\r\n          let errors;\r\n          if (err.response.data.errors.email) {\r\n            errors = err.response.data.errors.email[0];\r\n          } else {\r\n            errors = err.response.data.errors;\r\n          }\r\n\r\n          const response = {\r\n            error: true,\r\n            message: errors,\r\n          };\r\n\r\n          console.log(errors);\r\n          setResponse(response);\r\n          setIsSubmitting(false);\r\n        });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [errors]);\r\n\r\n  return {\r\n    handleEmailChange,\r\n    fields,\r\n    handleSubmit,\r\n    errors,\r\n    response,\r\n    success,\r\n  };\r\n};\r\n\r\nconst getToken = () => {\r\n  const params = new URLSearchParams(window.location.search);\r\n  if (params.has(\"token\")) {\r\n    return params.get(\"token\");\r\n  }\r\n  return \"\";\r\n};\r\n\r\nconst getUserId = () => {\r\n  const params = new URLSearchParams(window.location.search);\r\n  if (params.has(\"id\")) {\r\n    return params.get(\"id\");\r\n  }\r\n  return \"\";\r\n};\r\n\r\nexport const useResetPassword = (validate) => {\r\n  const [fields, setValues] = useState({\r\n    id: getUserId(),\r\n    token: getToken(),\r\n    password: \"\",\r\n    password_confirmation: \"\",\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [response, setResponse] = useState({\r\n    error: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const [success, setSuccess] = useState({\r\n    state: false,\r\n    message: \"\",\r\n  });\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setValues({\r\n      ...fields,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const response = {\r\n      error: false,\r\n      message: errors,\r\n    };\r\n    setResponse(response);\r\n    setErrors(validate(fields));\r\n    setIsSubmitting(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(errors).length === 0 && isSubmitting) {\r\n      const data = fields;\r\n      axios\r\n        .post(process.env.REACT_APP_API + `/api/password/reset`, data, {\r\n          headers: { Accept: \"application/json\" },\r\n        })\r\n        .then((res) => {\r\n          const success = {\r\n            state: true,\r\n            message: res.message,\r\n          };\r\n          console.log(success);\r\n          setSuccess(success);\r\n        })\r\n        .catch((err) => {\r\n          let errors = err.response.data.errors;\r\n\r\n          const response = {\r\n            error: true,\r\n            message: errors,\r\n          };\r\n\r\n          console.log(errors);\r\n          setResponse(response);\r\n          setIsSubmitting(false);\r\n        });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [errors]);\r\n\r\n  return {\r\n    handleChange,\r\n    fields,\r\n    handleSubmit,\r\n    errors,\r\n    response,\r\n    success,\r\n  };\r\n};\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}